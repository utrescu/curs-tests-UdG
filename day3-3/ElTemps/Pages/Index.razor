@page "/"
@attribute [Authorize]

@using ElTemps.Data
@inject PrevisioService PrevisioService
@inject NavigationManager NavigationManager

@if (Pobles == null)
{
    <p><em>Loading...</em></p>
}
else
{

    <section class="text-gray-600 body-font relative">
    <div class="container px-5 py-24 mx-auto flex sm:flex-nowrap flex-wrap">
        <div
            class="lg:w-2/3 md:w-1/2 bg-gray-300 rounded-lg overflow-hidden sm:mr-10 p-10 flex items-end justify-start relative">
            <iframe class="absolute inset-0" style="filter: grayscale(1) contrast(1.2) opacity(0.4);" title="map"
                marginheight="0" marginwidth="0" scrolling="no" src="img/mapa.png" width="100%" height="100%"
                frameborder="0"></iframe>
        </div>
        <div class="lg:w-1/3 md:w-1/2 bg-white flex flex-col md:ml-auto w-full md:py-8 mt-8 md:mt-0">
            <h2 class="text-gray-900 text-lg mb-1 font-medium title-font">El Bonyetès</h2>
            <p class="leading-relaxed mb-5 text-gray-600">Com tots sabeu la nostra comarca és única a Catalunya perquè
                cada un dels pobles que la forma té un microcrima individual. Per això és tant important que tinguem una
                bona previsió. Per poder prepara les activitats que farem sense haver de patir, ni haver de mirar les
                previsions de la televisió que, en el nostre cas, sempre fallen perquè no tenen en compte la nostra
                especificitat</p>
            <div class="relative mb-4">
                <label for="message" class="leading-7 text-sm text-black">Poble</label>
                <select class="block appearance-none w-full bg-white border border-gray-400 hover:border-gray-500 px-4 py-2 pr-8
                                rounded shadow leading-tight focus:outline-none focus:shadow-outline" @bind="@Poble">
                    <option value="">Tria el poble ...</option>
                    @foreach (var poble in Pobles)
                        {
                            <option value="@poble">@poble</option>
                        }
                    </select>
                </div>
                <p class="text-xs text-gray-500 mt-3">Aneu amb compte. S'ha vist per la comarca algun metereòleg de TV3
                    intentant descobrir
                    els nostres secrets</p>
            </div>
        </div>
    </section>
}

@code {
    private string[] Pobles;
    private string poble;

    string Poble
    {
        get => poble;
        set
        {
            poble = value;
            NavigationManager.NavigateTo("/previsio/" + poble, false);
        }
    }

    protected override async Task OnInitializedAsync()
    {
        Pobles = await PrevisioService.GetPobles();
    }
}
